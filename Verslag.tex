\documentclass{article}
\usepackage[a4paper]{geometry}
\usepackage{parskip}
\usepackage{amsmath, amssymb}
\usepackage{color}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage[dutch,english]{babel}
\usepackage {bm}
\usepackage{wasysym}
\usepackage{listings}
\usepackage{float}
\usepackage{epstopdf}

%\newcommand{\f}{\(f\)}
%\newcommand{\g}{\(g\)}
\newcommand{\Q}{\mathbb{Q}}
%\newcommand{\Z}{\mathbb{Z}}
%\newcommand{\R}{\mathbb{R}}
%\newcommand{\C}{\mathbb{C}}
%\newcommand{\N}{\mathbb{N}}
\newcommand{\QED}{\hfill\ensuremath{\square}}
\newcommand{\rk}{\text{rk}~}
\newcommand{\Dt}{\Delta t}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
 
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
\lstset{style=mystyle}
\title{Numerieke Methoden 1 Practicum Traffic Flow}

\author{Casper Barendrecht \& Stijn Moerman\\ s1693441 \& s1696874}

\date{\today}


\begin{document}
\maketitle



\textbf{Opgave 1}\\
Laat \(u(x,t)=\alpha\rho + \beta\).

Er geldt:
\begin{align}
	\frac{\partial \rho}{\partial t}+\frac{\partial}{\partial x}(\rho(1-\rho))=\nu \frac{\partial^2 \rho}{\partial x^2},~\nu\in \mathbb{R}_+ \\
 \frac{\partial u}{\partial t}+\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right) = \nu \frac{\partial^2 u}{\partial x^2},~\nu\in \mathbb{R}_+
\end{align}
derp
\begin{align*}
 \frac{\partial u}{\partial t} &=\alpha\frac{\partial \rho}{\partial t}\\
\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right)&=\frac{1}{2}\frac{\partial}{\partial x}(\alpha^2\rho^2 +2\alpha\beta\rho+\beta^2)= \frac{1}{2}(\alpha^2+2\alpha\beta)\frac{\partial \rho}{\partial x}\\
\nu \frac{\partial^2 u}{\partial x^2}&=\alpha \nu\frac{\partial^2 \rho}{\partial x^2}
\end{align*}
En dus:
\begin{align*}
	\alpha\frac{\partial \rho}{\partial t}+\frac{1}{2}(\alpha^2+2\alpha\beta)\frac{\partial \rho}{\partial x}=\alpha \nu\frac{\partial^2 \rho}{\partial x^2}
\end{align*}
%We vinden \(\alpha=1\).





\textbf{Opgave 2:}
We hebben:
\begin{align*}
\frac{\partial u}{\partial t} &= \nu \frac{\partial^2 u}{\partial x^2} -\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right) &\text{ voor } 0<x<L, t>0\\
u(0,t) &= -1 &\text{ voor } t\geq 0\\
\frac{\partial u}{\partial x}(L,t) &= 0 &\text{ voor } t\geq 0\\
u(x,0) &= 0 &\text{ voor } 0<x<L
\end{align*}
En we doen de discretisatie z.d.d. $x_0 = 0$, $x_i= i \Delta x$ en $x_{N+1}=L$, dus $\Delta x = \frac{L}{N+1}$.
In het vervolg geldt $u_i=u(x_i)$.
We schrijven de eerste formule in de vorm voor $\vec{u} = (u_1,\dots,u_{N+1})^\intercal$:
\begin{align*}
\dot{\vec{u}} = \nu K \vec{u} - \vec{f}(\vec{u})+\vec{r}(\vec{u})
\end{align*}
Voor $1\leq i\leq N+1$ geldt:
\begin{align*}
-\frac{\partial^2 u}{\partial x^2}(x_i) &= \frac{-u_{i-1}+2u_i-u_{i+1}}{\Delta x^2}\\
\left(\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right)\right)(x_i) &= \frac{-\frac{1}{2}u_{i-1}^2+\frac{1}{2}u_{i+1}^2}{2\Delta x}
= \frac{-u_{i-1}^2+u_{i+1}^2}{4\Delta x}
\end{align*}
Ook hebben we:
\begin{align*}
-\frac{\partial^2 u}{\partial x^2}(x_1) &= \frac{-u_{0}+2u_1-u_{2}}{\Delta x^2}
= \frac{1+2u_1-u_{2}}{\Delta x^2}
= \frac{2u_1-u_{2}}{\Delta x^2} +\frac{1}{\Delta x^2}\\
\left(\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right)\right)(x_1) &= \frac{-u_{0}^2+u_{2}^2}{4\Delta x}
= \frac{-1+u_{2}^2}{4\Delta x}
= \frac{u_{2}^2}{4\Delta x}+\frac{-1}{4\Delta x}
\end{align*}
Voor $u_{N+1}$ kunnen we onze beginvoorwaarde verwerken d.m.v. het virtuele punt $x_{N+2}$.
We krijgen dan:
\begin{align*}
0=\dot{u}_{N+1} = \frac{-u_{N}+u_{N+2}}{2\Delta x}
\end{align*}
Dus $u_{N+2}=u_N$.
We hebben dan dus:
\begin{align*}
-\frac{\partial^2 u}{\partial x^2}(x_{N+1}) &= \frac{-u_{N}+2u_{N+1}-u_{N+2}}{\Delta x^2}
= \frac{-u_{N}+2u_{N+1}}{\Delta x^2} +\frac{-u_{N}}{\Delta x^2}\\
\left(\frac{\partial}{\partial x}\left(\frac{1}{2}u^2\right)\right)(x_{N+1}) &= \frac{-u_{N}^2+u_{N+2}^2}{4\Delta x}
= \frac{-u_{N}^2}{4\Delta x} +\frac{u_{N}^2}{4\Delta x}
\end{align*}

Dus we krijgen dan:
\begin{align*}
K = -\begin{pmatrix}
2 & -1 & 0 & \hdots & 0 & 0\\
-1 & 2 & -1 & \hdots & 0 & 0\\
0 & -1 & 2 & \hdots & 0 & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & 0 & \hdots & 2 & -1\\
0 & 0 & 0 & \hdots & -1 & 2\\
\end{pmatrix}\cdot\frac{1}{\Delta x^2}
\end{align*}
en
\begin{align*}
\vec{f}(\vec{u}) = 
\begin{pmatrix}
1
\end{pmatrix}
\cdot\frac{1}{4\Delta x}
\end{align*}



\end{document}
